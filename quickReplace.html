<!--
This app is completely self-contained. You don't even need a web server, you can just open the html
file in a browser from your local machine and run it directly.

@author Kip Robinson, https://github.com/kiprobinson
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>QuickReplace</title>
<link rel="shortcut icon" href="http://dl.dropbox.com/u/5738517/favicon-qr.ico"/> 
<style type="text/css">
/* Copied from: http://yui.yahooapis.com/3.3.0/build/cssreset/reset-min.css */
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var{font-style:normal;font-weight:normal;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:text-top;}sub{vertical-align:text-bottom;}input,textarea,select{font-family:inherit;font-size:inherit;font-weight:inherit;}input,textarea,select{*font-size:100%;}legend{color:#000;}
/* --- end Yahoo reset script --- */

html {
  background-color: #cdc;
}
body {
  font-family: Tahoma,Arial,sans-serif;
  font-size: 0.8em;
  padding: 1px;
  padding-right: 5px;
}
textarea,input[type=text] {
  /* Font list from StackOverflow.com ... */
  font-family: Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;
  font-size: 0.8em;
  border: 1px solid black;
  margin: 1px;
  resize: none;
}
input {
  padding-left: 2px;
  padding-right: 2px;
}
strong {
  color: #666;
  font-weight: bold;
}
#input, #output {
  width: 100%;
  height: 250px;
  border: 1px solid black;
}
#output {
  color: #888;
}
textarea:focus, input[type=text]:focus {
  background-color: #ffb;
}
.example {
  font-size: 0.75em;
  color: #888;
}
.example, label {
  white-space: nowrap;
}
.options-input {
  width: 20px;
}
.button {
  border: 1px solid black;
  background-color: #ccc;
  cursor: default;
  padding-left: 2px;
  padding-right: 2px;
}
.button:hover {
  background-color: #ffb;
}
.handle {
  cursor: move;
}
.disabled {
  opacity: 0.5;
}
td {
  padding-left: 2px;
  padding-right: 2px;
}
a, a:visited {
  color: blue;
}
</style>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
<script type="text/javascript">
//<![CDATA[ 

$(function() {
  //globals
  var _G = {
    PREPEND: 0,
    SIMPLE: 1,
    REGEX: 2,
    GREP: 3,
    maxFilterId: 0,
    filters: null,
    idleTimer: null
  };
  
  var rb = loadResourceBundle();
  
  document.title = rb.pageTitle;
  $('#addFilterLabel').text(rb.addFilter);
  $('#addFilterPrepend').val(rb.prependType);
  $('#addFilterSimple').val(rb.simpleType);
  $('#addFilterRegex').val(rb.regexType);
  $('#addFilterGrep').val(rb.grepType);
  $('#permalink').text(rb.permalink);
  $('#copyUp').val(rb.copyUp).attr('title', rb.copyUpTooltip);
  
  //---------------------------------------------------------------------------
  // Initialization
  //---------------------------------------------------------------------------
  $('#input').focus();
  $('body').css('overflow', 'hidden');
  $('#filters').sortable({revert:100, helper:'clone', opacity: 0.75, handle: '.handle', axis: 'y', stop: updateFilters});
  
  try {
    _G.filters = $.parseJSON(getUrlParam('filters'));
  } catch (e) {}
  
  if(!$.isArray(_G.filters)) {
    _G.filters = [
      {type: _G.PREPEND},
      {type: _G.SIMPLE},
      {type: _G.REGEX}
    ]
  }
  
  
  initFilters(_G.filters);
  
  //---------------------------------------------------------------------------
  // Listeners
  //---------------------------------------------------------------------------
  $(window).resize(resizeInputs);
  
  $('#addFilterPrepend').click(function() { return addFilter(_G.PREPEND); });
  $('#addFilterSimple') .click(function() { return addFilter(_G.SIMPLE ); });
  $('#addFilterRegex')  .click(function() { return addFilter(_G.REGEX  ); });
  $('#addFilterGrep')   .click(function() { return addFilter(_G.GREP   ); });
  
  $('#filters input[type=text]').live('keyup', updateFilters);
  $('#filters input[type=checkbox]').live('change', updateFilters);
  $('#input').keyup(applyFilters);
  $('.remove-filter').live('click', function() {
    $(this).closest('tr').remove();
    updateFilters();
    resizeInputs();
  });
  
  //Select all text in output when it gets focus
  $('#output').focus(function(){
    $(this).select();
    //workaround required b/c of this webkit bug: http://code.google.com/p/chromium/issues/detail?id=4505
    if($.browser.webkit) {
      $(this).mouseup(function(e) {
        e.preventDefault();
        $(this).unbind('mouseup');
      });
    }
  });
  
  //Copy content from output to input, and rerun filter.
  $('#copyUp').click(function(){
    $('#input').val($('#output').val());
    applyFilters();
  });
  
  //Utilize history API if available
  if(supportsHistoryApi()){
    $(window).bind('popstate', function(e) {
      var state = e.originalEvent.state;
      if(state != null)
        initFilters(e.originalEvent.state);
    });
    
    //Add Ctrl+S event mapping to save to address bar
    $(document).keydown(function(e) {
      if(e.ctrlKey && !e.altKey && (e.which == 83)) {
        e.preventDefault();
        saveState();
      }
    });
  }
  
  
  //---------------------------------------------------------------------------
  // Core functions
  //---------------------------------------------------------------------------
  
  
  function initFilters(filters) {
    $('#filters').empty();
    $.each(filters, function() {
      addFilter(this.type, this, true);
    });
    updateFilters();
    resizeInputs();
  }
  
  /**
   * Appends a filter to the filter controls.
   * @param type: One of the global constants PREPEND, SIMPLE, or REGEX.
   * @param args: Initial values for parameter arguments. Any unspecified paramters will use defaults.
   * @param isStartup: If set and true, skips call to updateFilters and resizeInputs. Pass true during startup, to prevent
   *                   redundant work when loading default or passed-in filters.
   */
  function addFilter(type, args, isStartup) {
    var filter = '';
    if(!$.isPlainObject(args))
      args = {};
    
    if(typeof args.enabled == 'undefined')
      args.enabled = true;
    
    if(type == _G.PREPEND) {
      if (typeof args.prepend == 'undefined')
        args.prepend = '';
      if (typeof args.append == 'undefined')
        args.append = '';
      if (typeof args.ignoreBlanks == 'undefined')
        args.ignoreBlanks = false;
      filter = '<tr id="filter_' + (++_G.maxFilterId) + '" class="filter prepend-filter">'
             +   '<td><span class="button handle" title="' + rb.rearrangeTooltip + '">&#8597;</span></td>'
             +   '<td><span class="button remove-filter" title="' + rb.removeTooltip + '">X</span></td>'
             +   '<td><input type="checkbox" id="enabled_' + _G.maxFilterId + '"' + (args.enabled?' checked':'') + ' title="' + rb.enableTooltip + '" /></td>'
             +   '<td title="' + rb.prependTooltip + '"><label for="prepend_' + _G.maxFilterId + '">' + rb.prependLabel + '</label></td>'
             +   '<td title="' + rb.prependTooltip + '"><input type="text" class="flex-input" id="prepend_' + _G.maxFilterId + '" value="' + escapeHtml(escapeJS(args.prepend)) + '" placeholder="' + rb.prependPlaceholder + '" /></td>'
             +   '<td title="' + rb.appendTooltip + '"><label for="append_' + _G.maxFilterId + '">' + rb.appendLabel + '</label></td>'
             +   '<td title="' + rb.appendTooltip + '"><input type="text" class="flex-input" id="append_' + _G.maxFilterId + '" value="' + escapeHtml(escapeJS(args.append)) + '" placeholder="' + rb.appendPlaceholder + '" /></td>'
             +   '<td colspan="3">'
             +     '<label title="' + rb.ignoreBlanksTooltip + '" for="ignoreBlanks_' + _G.maxFilterId + '">' + rb.ignoreBlanks + '</label> '
             +     '<input title="' + rb.ignoreBlanksTooltip + '" type="checkbox" id="ignoreBlanks_' + _G.maxFilterId + '" ' + (args.ignoreBlanks?'checked="checked"':'') + ' />'
             +   '</td>'
             + '</tr>';
    }
    else if (type == _G.SIMPLE) {
      if (typeof args.find == 'undefined')
        args.find = '';
      if (typeof args.replace == 'undefined')
        args.replace = '';
      if (typeof args.options == 'undefined')
        args.options = 'gim';
      filter = '<tr id="filter_' + (++_G.maxFilterId) + '" class="filter simple-filter">'
             +   '<td><span class="button handle" title="' + rb.rearrangeTooltip + '">&#8597;</span></td>'
             +   '<td><span class="button remove-filter" title="' + rb.removeTooltip + '">X</span></td>'
             +   '<td><input type="checkbox" id="enabled_' + _G.maxFilterId + '"' + (args.enabled?' checked':'') + ' title="' + rb.enableTooltip + '" /></td>'
             +   '<td title="' + rb.simpleFindTooltip + '"><label for="find_' + _G.maxFilterId + '">' + rb.simpleFindLabel + '</label></td>'
             +   '<td title="' + rb.simpleFindTooltip + '"><input type="text" class="flex-input" id="find_' + _G.maxFilterId + '" value="' + escapeHtml(escapeJS(args.find)) + '" placeholder="' + rb.simpleFindPlaceholder + '" /></td>'
             +   '<td title="' + rb.simpleReplaceTooltip + '"><label for="replace_' + _G.maxFilterId + '">' + rb.simpleReplaceLabel + '</label></td>'
             +   '<td title="' + rb.simpleReplaceTooltip + '"><input type="text" class="flex-input" id="replace_' + _G.maxFilterId + '" value="' + escapeHtml(escapeJS(args.replace)) + '" placeholder="' + rb.simpleReplacePlaceholder + '" /></td>'
             +   '<td><label for="options_' + _G.maxFilterId + '">' + rb.simpleReplaceOptions + '</label></td>'
             +   '<td><input type="text" class="options-input" id="options_' + _G.maxFilterId + '" value="' + escapeHtml(args.options) + '" /></td>'
             +   '<td class="example">' + rb.simpleReplaceOptionsDescription + '</td>'
             + '</tr>';
    }
    else if (type == _G.REGEX) {
      if (typeof args.regex == 'undefined')
        args.regex = '';
      if (typeof args.replacement == 'undefined')
        args.replacement = '';
      if (typeof args.options == 'undefined')
        args.options = 'gim';
      filter = '<tr id="filter_' + (++_G.maxFilterId) + '" class="filter regex-filter">'
             +   '<td><span class="button handle" title="' + rb.rearrangeTooltip + '">&#8597;</span></td>'
             +   '<td><span class="button remove-filter" title="' + rb.removeTooltip + '">X</span></td>'
             +   '<td><input type="checkbox" id="enabled_' + _G.maxFilterId + '"' + (args.enabled?' checked':'') + ' title="' + rb.enableTooltip + '" /></td>'
             +   '<td title="' + rb.regexFindTooltip + '"><label for="regex_' + _G.maxFilterId + '">' + rb.regexFindLabel + '</label></td>'
             +   '<td title="' + rb.regexFindTooltip + '"><input type="text" class="flex-input" id="regex_' + _G.maxFilterId + '" value="' + escapeHtml(args.regex) + '" placeholder="' + rb.regexFindPlaceholder + '" /></td>'
             +   '<td title="' + rb.regexReplaceTooltip + '"><label for="replacement_' + _G.maxFilterId + '">' + rb.regexReplaceLabel + '</label></td>'
             +   '<td title="' + rb.regexReplaceTooltip + '"><input type="text" class="flex-input" id="replacement_' + _G.maxFilterId + '" value="' + escapeHtml(escapeJS(args.replacement)) + '" placeholder="' + rb.regexReplacePlaceholder + '" /></td>'
             +   '<td><label for="options_' + _G.maxFilterId + '">' + rb.regexReplaceOptions + '</label></td>'
             +   '<td><input type="text" class="options-input" id="options_' + _G.maxFilterId + '" value="' + escapeHtml(args.options) + '" /></td>'
             +   '<td class="example">' + rb.regexReplaceOptionsDescription + '</td>'
             + '</tr>';
    }
    else if (type == _G.GREP) {
      if (typeof args.regex == 'undefined')
        args.regex = '';
      if (typeof args.caseSensitive == 'undefined')
        args.caseSensitive = false;
      if (typeof args.invert == 'undefined')
        args.invert = false;
      filter = '<tr id="filter_' + (++_G.maxFilterId) + '" class="filter grep-filter">'
             +   '<td><span class="button handle" title="' + rb.rearrangeTooltip + '">&#8597;</span></td>'
             +   '<td><span class="button remove-filter" title="' + rb.removeTooltip + '">X</span></td>'
             +   '<td><input type="checkbox" id="enabled_' + _G.maxFilterId + '"' + (args.enabled?' checked':'') + ' title="' + rb.enableTooltip + '" /></td>'
             +   '<td title="' + rb.grepTooltip + '"><label for="grep_' + _G.maxFilterId + '">' + rb.grepLabel + '</label></td>'
             +   '<td title="' + rb.grepTooltip + '"><input type="text" class="flex-input" id="regex_' + _G.maxFilterId + '" value="' + escapeHtml(args.regex) + '" placeholder="' + rb.grepPlaceholder + '" /></td>'
             +   '<td colspan="5">'
             +     '<label title="' + rb.caseSensitiveTooltip + '" for="caseSensitive_' + _G.maxFilterId + '">' + rb.caseSensitiveLabel + '</label> '
             +     '<input title="' + rb.caseSensitiveTooltip + '" type="checkbox" id="caseSensitive_' + _G.maxFilterId + '" ' + (args.caseSensitive?'checked="checked"':'') + ' /> | '
             +     '<label title="' + rb.invertTooltip + '" for="invert_' + _G.maxFilterId + '">' + rb.invertLabel + '</label> '
             +     '<input title="' + rb.invertTooltip + '" type="checkbox" id="invert_' + _G.maxFilterId + '" ' + (args.invert?'checked="checked"':'') + ' />'
             +   '</td>'
             + '</tr>';
    }
    
    if(filter) {
      $('#filters').append(filter);
      if(!isStartup) {
        updateFilters();
        resizeInputs();
      }
    }
    return false;
  }
  
  /**
   * Updates the _G.filters array based on current arrangement/values.
   */
  function updateFilters()
  {
    var oldPermalink = getPermalink();
    _G.filters = [];
    $('#filters>.filter').each(function() {
      var id = this.id.substr(this.id.lastIndexOf('_') + 1);
      var filter = {id: id};
      if($(this).hasClass('prepend-filter')) {
        filter.type = _G.PREPEND;
        filter.enabled = $('#enabled_' + id)[0].checked;
        filter.prepend = unescapeJS($('#prepend_' + id).val());
        filter.append = unescapeJS($('#append_' + id).val());
        filter.ignoreBlanks = $('#ignoreBlanks_' + id)[0].checked;
      }
      else if($(this).hasClass('simple-filter')) {
        filter.type = _G.SIMPLE;
        filter.enabled = $('#enabled_' + id)[0].checked;
        filter.find = unescapeJS($('#find_' + id).val());
        filter.replace = unescapeJS($('#replace_' + id).val());
        filter.options = $('#options_' + id).val();
      }
      else if($(this).hasClass('regex-filter')) {
        filter.type = _G.REGEX;
        filter.enabled = $('#enabled_' + id)[0].checked;
        filter.regex = $('#regex_' + id).val();
        filter.replacement = unescapeJS($('#replacement_' + id).val());
        filter.options = $('#options_' + id).val();
      }
      else if($(this).hasClass('grep-filter')) {
        filter.type = _G.GREP;
        filter.enabled = $('#enabled_' + id)[0].checked;
        filter.regex = $('#regex_' + id).val();
        filter.caseSensitive = $('#caseSensitive_' + id)[0].checked;
        filter.invert = $('#invert_' + id)[0].checked;
      }
      if(typeof filter.type != 'undefined') {
        _G.filters.push(filter);
        $('#filter_' + id).toggleClass('disabled', !filter.enabled);
      }
    });
    
    var newPermalink = getPermalink();
    if(oldPermalink != newPermalink) {
      $('#permalink').attr('href', newPermalink);
      setIdleTimer();
    }
    applyFilters();
  }
  
  /**
   * Applies all filters to the current input text.
   */
  function applyFilters()
  {
    var text = $('#input').val();
    try
    {
      $.each(_G.filters, function(i, filter)
      {
        if(filter.enabled)
        {
          if(filter.type == _G.PREPEND)
          {
            if(filter.prepend.length > 0 || filter.append.length > 0)
            {
              //text = filter.prepend + text.replace(/\n/g, filter.append + "\n" + filter.prepend) + filter.append;
              var regex = new RegExp(filter.ignoreBlanks ? '^(.+)$' : '^(.*)$', 'gm');
              var replace = filter.prepend.replace('$', '$$') + '$1' + filter.append.replace('$', '$$');
              text = text.replace(regex, replace);
            }
          }
          else if(filter.type == _G.SIMPLE)
          {
            if(filter.find.length > 0)
              text = text.replace(new RegExp(regexQuote(filter.find), filter.options), filter.replace);
          }
          else if(filter.type == _G.REGEX)
          {
            if(filter.regex.length > 0)
              text = text.replace(new RegExp(filter.regex, filter.options), filter.replacement);
          }
          else if(filter.type == _G.GREP)
          {
            if(filter.regex.length > 0) {
              var regex = new RegExp(filter.regex, filter.caseSensitive ? '' : 'i');
              var lines = text.split('\n');
              text = '';
              for(var i = 0; i < lines.length; i++) {
                if(regex.test(lines[i]) != filter.invert)
                  text += (text.length > 0 ? '\n' : '') + lines[i];
              }
            }
          }
        }
      });
      $('#output').val(text);
    }
    catch(err)
    {
      $('#output').val("ERROR:\n" + err);
    }
  }
  
  /**
   * Adjusts the size of the input controls so that they will fill up the whole screen.
   */
  function resizeInputs() {
    //The text areas should fill the whole vertical space
    var minHeight = 50;
    var newHeight = $(window).height() - ($('body').height() - $('#input').height() - $('#output').height());
    newHeight = Math.max(Math.floor(newHeight/2), minHeight);
    $('textarea').height(newHeight);
    
    //The flex-input elements should fill the whole horizontal space
    var minFlexWidth = 100;
    var newFlexWidth = $('body').width() - $('#filters').width() + 2 * Number($('.flex-input:first').width());
    newFlexWidth = Math.max(Math.floor(newFlexWidth/2), minFlexWidth);
    $('.flex-input').width(newFlexWidth);
  }
  
  
  function setIdleTimer() {
    if(_G.idleTimer !== null)
      clearTimeout(_G.idleTimer);
    _G.idleTimer = setTimeout(function() {
      saveState();
    }, 10000);
  }
  
  
  /**
   * Saves current filter state to the browser's address bar, if supported.
   */
  function saveState() {
    if(supportsHistoryApi()) {
      history.pushState(_G.filters, 'QuickReplace', getPermalink());
      if(_G.idleTimer !== null) {
        clearTimeout(_G.idleTimer);
        _G.idleTimer = null;
      }
    }
  }
  
  
  /**
   * Returns a properly escaped/encoded permalink to the current filters.
   */
  function getPermalink() {
    return '?filters=' + encodeURIComponent(JSON.stringify(_G.filters));
  }
  
  //---------------------------------------------------------------------------
  // Helper functions
  //---------------------------------------------------------------------------
  
  /**
   * Escapes any characters which are special characters in a regular expression.
   */
  function regexQuote(str) {
    return str.replace(/([\.\\\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:\-])/g, '\\$1');
  }
  
  /**
   * Converts \n to newline, \t to tab, and \\ to \ in given string. All other
   * backslashes are left as-is.
   */
  function unescapeJS(str)
  {
    if(typeof str != 'string')
      return '';
    
    if(!(str.length > 0 && str.search(/\\[\\nt]/) >= 0))
      return str;
    
    var ret = '';
    var bsFound = false;
    for(var i = 0; i < str.length; i++)
    {
      var ch = str.charAt(i);
      if(bsFound)
      {
        if(ch == 'n')
          ret += "\n";
        else if (ch == 't')
          ret += "\t";
        else if (ch == "\\")
          ret += "\\";
        else
          ret += "\\" + ch;
        
        bsFound = false;
      }
      else
      {
        if(ch == "\\" && i != str.length - 1)
          bsFound = true;
        else
          ret += ch;
      }
    }
    
    return ret;
  }
  
  /**
   * Escapes literal newlines and tabs to \n and \t. Also escapes bare backslashes with \\.
   */
  function escapeJS(str) {
    if(typeof str != 'string')
      return '';
    return str.replace(/\\/g, '\\\\')
              .replace(/\n/g, '\\n')
              .replace(/\t/g, '\\t');
  }
  
  /**
   * From: http://www.onlineaspect.com/2009/06/10/reading-get-variables-with-javascript/
   */
  function getUrlParam(q,s) {
    s = s ? s : window.location.search;
    var re = new RegExp('&'+q+'(?:=([^&]*))?(?=&|$)','i');
    s = s.replace(/^\?/,'&').match(re);
    if(s) 
      return typeof s[1] != 'undefined' ? decodeURIComponent(s[1]) : '';
  }
  
  function escapeHtml(unsafe) {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }
  
  function supportsHistoryApi() {
    //disabling this for now... seems to be buggy with backslashes in the url...
    return false;
    //return !!(window.history && history.pushState);
  }
  
  function loadResourceBundle() {
    //TODO: support parameterizing
    locale = 'en-us';
    
    var resources = {
      'en-us': {
        pageTitle: 'QuickReplace',
        addFilter: 'AddFilter',
        permalink: 'Permalink',
        rearrangeTooltip: 'Drag up or down to rearrange filters',
        removeTooltip: 'Remove this filter',
        enableTooltip: 'Enable/disable this filter',
        copyUp: '\u2191 Move \u2191',
        copyUpTooltip: '',
        
        prependType: 'Prepend',
        prependLabel: 'Prepend:',
        prependPlaceholder: '\\n,\\t allowed',
        prependTooltip: '',
        appendLabel: 'Append:',
        appendPlaceholder: '\\n,\\t allowed',
        appendTooltip: '',
        ignoreBlanks: 'Ignore blank lines:',
        ignoreBlanksTooltip: '',
        
        simpleType: 'Simple',
        simpleFindLabel: 'Simple find:',
        simpleFindPlaceholder: '\\n,\\t allowed',
        simpleFindTooltip: '',
        simpleReplaceLabel: 'Simple replace:',
        simpleReplacePlaceholder: '\\n,\\t allowed',
        simpleReplaceTooltip: '',
        simpleReplaceOptions: 'Options:',
        simpleReplaceOptionsDescription: '<strong>g</strong>lobal case-<strong>i</strong>nsensitive <strong>m</strong>ulti-line',
        
        regexType: 'Regex',
        regexFindLabel: 'Regex find:',
        regexFindPlaceholder: 'No start/end markers',
        regexFindTooltip: '',
        regexReplaceLabel: 'Regex replace:',
        regexReplacePlaceholder: 'backrefs: $1 $2 etc',
        regexReplaceTooltip: '',
        regexReplaceOptions: 'Options:',
        regexReplaceOptionsDescription: '<strong>g</strong>lobal case-<strong>i</strong>nsensitive <strong>m</strong>ulti-line',
        
        grepType: 'Grep',
        grepLabel: 'Regex grep:',
        grepPlaceholder: 'No start/end markers',
        grepTooltip: '',
        caseSensitiveLabel: 'Case-sensitive',
        caseSensitiveTooltip: '',
        invertLabel: 'Invert',
        invertTooltip: ''
      }
    };
    
    //for testing...
    //$.each(resources['en-us'], function(k,v) {
    //  resources['en-us'][k] = '[_' + k + '_]';
    //});
    
    return resources[locale] || resources['en-us'];
  }
});
//]]> 
</script>
</head>
<body>
<table>
  <tbody id="filters">
  </tbody>
</table>
<div id="controls">
  <span id="addFilterLabel">Add filter:</span>
  <input type="submit" id="addFilterPrepend" value="Prepend" />
  <input type="submit" id="addFilterSimple" value="Simple" />
  <input type="submit" id="addFilterRegex" value="Regex" />
  <input type="submit" id="addFilterGrep" value="Grep" />
  | <a href="#" id="permalink">Permalink</a>
</div>
<textarea id="input" wrap="off"></textarea>
<input type="submit" id="copyUp" value="&uarr; Move &uarr;" />
<textarea id="output" readonly="readonly" wrap="off"></textarea>
</body>
</html>
